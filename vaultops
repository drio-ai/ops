#!/bin/bash

if [[ $1 == "start" ]]; then
    make vault-build && make vault-start
    vault_status=$(docker ps --filter "name=vault" --filter "status=running" | grep -w vault)
    if [[ -z ${vault_status} ]]; then
        echo "Failed to start vault"
        exit 1
    fi

    sleep 10
    docker exec -ti vault /init-vault.sh
elif [[ $1 == "stop" ]]; then
    make vault-stop-clean
elif [[ $1 == "stop-clean" ]]; then
    make vault-stop-clean
    make vault-build-clean
fi
